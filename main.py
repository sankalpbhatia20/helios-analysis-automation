from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch
import requests
import pandas as pd
import numpy as np

from main_deepgram import *

def main(self):
    pass

tokenizer = AutoTokenizer.from_pretrained('nlptown/bert-base-multilingual-uncased-sentiment')
model = AutoModelForSequenceClassification.from_pretrained('nlptown/bert-base-multilingual-uncased-sentiment')

#sentence_list = ['Good afternoon, and welcome to the GameStop Second Quarter 20 22 Earnings Conference Call', 'Please note that statements made during the call constitute forward looking statements made pursuant to the Safe Harbor provisions of the Private Securities Litigation Act of 19 95 as amended', 'Such forward looking statements are subject to both known and unknown risks and uncertainties that could cause actual results to differ materially from such statements', "These risks and uncertainties are described in the company's earnings press release and its filings with the SEC", 'The forward looking statements today are made as of the date of this call, and the company does not undertake any obligation to update the forward looking statements', "I will now turn the call over to GameStop's CEO, Matt Furlong", 'Thank you, and good afternoon, everyone', 'I want to begin by reiterating the deep appreciation we have for our stockholders unrivaled enthusiasm, passion and support', 'As we work to transform GameStop, these remain unique tailwinds for us, ones we always recognize and value', 'I also want to take this opportunity to thank everyone across the organization for bringing continued focus and intensity to our mission', 'particularly during an active Q2 that represented a transitional quarter for us', "Before covering the quarter's specific initiatives and results, I want to provide a high level update on where we've been and where we're looking to go as our transformation progresses", 'When our Board began turning over early last year, GameStop was saddled with significant debt to Keying Systems, limited employee depth and a host of other issues', 'This is why we spent the second half of 20 21 and the first half of 20 22 making up for years of underinvestment and modernizing the business', 'The upshot is we now have a more diversified product catalog, strengthened fulfillment network, improved tech stack and e commerce presence and fortified corporate infrastructure', "Thanks to these improvements, including our SAP implementation, we're able to start focusing on a new set of priorities that include achieving profitability, launching proprietary products, leveraging our brand in new ways and investing further in our stores", 'During Q2, we took steps to support each of these new priorities', 'With respect to pursuing profitability in the coming quarters, we right sized corporate venditures and headcount following a period in which the company had hired more than 600 new individuals', 'These actions combined with the elimination of 1 time expenses in Q1 contributed to a 14.3 percent reduction in SG and A', "We've done this while improving our e commerce experience and reducing free shipping to customers to 1 to 3 days", "We're going to retain a strong focus on cost containment and continue promoting an ownership mentality across the organization", 'On the product front, our enhanced tech capabilities allowed us to follow the launch of our digital wallet with the launch of our new marketplace that allows gamers, creators, collectors and others to buy, sell and trade NFTs', "The launch of our NFT marketplace supports GameStop's pursuit of long term growth in the cryptocurrency, NFT and Web 3 gaming verticals, all of which we expect to be increasingly relevant the collectors and gamers of the future", "When it comes to accretive partnerships, we've been actively exploring opportunities to strengthen GameStop's offerings and increase brand visibility", "We're building on the momentum established by our previously disclosed partnerships with organizations like immutable and loop ring, whether it be through new relationships that support our commerce business, blockchain group or both", 'The deal we just announced with FTX is a byproduct of our commerce and blockchain teams working together to establish something unique in the retail world', 'Lastly, when it comes to investing in our stores, we rolled out an improved compensation model for U', 'S', 'store leaders Each of these store leaders is being given a time based equity grant of 21000 dollars that best over 3 years as well as the opportunity to earn additional compensation every quarter via a performance based equity grant', "In conjunction, we're raising hourly pay for certain store associates", 'These steps were taken to help us enhance retention and recruitment of passionate quality talent', 'When we think about the GameStop of the Future, we expect our stores to help us maintain direct connectivity to customers and sustain localized order fulfillment equities across more geographies', "This is why even as we continue evolving our e commerce and digital asset offerings to stores will remain a critical piece of the company's value proposition", 'Taken together, we believe the aforementioned step can help us attain profitability in the coming quarters and produce additional revenue growth over the long term', 'Let me now turn to our financial results for Q2', "Net sales were 1136000000.000 dollars for the quarter, compared to 1183000000.000 dollars in the prior year's second quarter", 'Sales attributable to new and expanded brand relationships remained strong', "It is also worth noting that sales attributable to collectibles, which is a segment we intend to grow over the long term or 223200000.0 dollars for the quarter compared to 177200000.0 dollars in the prior year's second quarter", "SG and A was 387500000.0 dollars or 34.1 percent of sales, compared to 378900000.0 dollars or 32 percent of sales in last year's second quarter", "As noted, we had a strong reduction in SG and A on a sequential basis versus Q1 of this year, and we're taking further steps to reduce SG and A on a go forward basis", "We reported a net loss of 108700000.0 dollars or 0.36 dollars per diluted share compared to a net loss of 61600000.0 dollars or a loss per diluted share of 0.21 dollars in the prior year's second quarter", 'there were no major 1 time transformation, transaction or related costs during the period', 'Turning to the balance sheet, we ended the quarter with cash and cash equivalents of 908900000.0 dollars', 'We continue to maintain a sizable cash position even while investing in inventory to sustain strong in stock levels and mitigate the full impact of lingering supply chain issues', "At the close of the second quarter, we had no borrowings under our ABL facility and no debt other than a low interest unsecured term loan associated with the French government's response to COVID-nineteen", 'Total liabilities compared to the second quarter of last year were down 237800000.0 dollars', "Capital expenditures for the quarter were 20500000.0 dollars, up 7000000 dollars from last year's second quarter, reflecting investments in our technology and enterprise systems", 'We anticipate CapEx will remain at modest levels', 'In the second quarter, cash flow from operations was an outflow of 103400000.0 dollars compared to an outflow of 11000000 dollars during the same period last year', "Inventory was 734800000.0 dollars at the close of the quarter compared to 596400000.0 dollars at the close of the prior year's second quarter", "In terms of an outlook, we're not providing formal guidance at this time", 'It is worth noting, however, that our ongoing engagement with key suppliers is positioning us to receive stronger supply of next generation consoles in the months ahead', "I want to finish by reinforcing that we're working to accomplish something unprecedented in our industry, transform a legacy brick and mortar retail dealers into a technology led organization that meets customers' needs through stores, e commerce properties and both digital marketplaces and new online communities", 'Our path to becoming a more diversified and tech centric business is 1 that obviously carries risk and will take time', 'This said, we believe GameStop is a much stronger business than it was 18 months ago', "I'll leave it there for this quarter", 'We look forward to driving more progress in Q3', "Thank This concludes today's conference", 'You may disconnect your lines at this time', 'Thank you for your participation.']
sentence_list = response
df = pd.DataFrame(np.array(sentence_list), columns = ['sentence'])

def sentiment_score(sentence):
    tokens = tokenizer.encode(sentence , return_tensors = 'pt')
    result = model(tokens)
    return int(torch.argmax(result.logits))+1

df['sentiment'] = df['sentence'].apply(lambda x: sentiment_score(x[:512]))

avg_sentiment_score = np.mean(df['sentiment'])
print("Overall Average Score of the Transcript: {}".format(avg_sentiment_score))
